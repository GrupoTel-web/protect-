<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Escalonamento</title>
  <link rel="icon" type="image/png" href="icons/nt.png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(to left, #ff6f00,  #dfb343, #ff6f00);
      margin: 0;
      padding: 20px;
    }

    /* Container principal com cantos arredondados e sombra */
    .container-principal {
      background-color: #fff;
      border-radius: 15px;
      padding: 20px;
      margin: 20px auto;
      width: 90%;
      max-width: 1000px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      zoom: 85%;
      user-select: none; 
    }

    /* Estilo do cabe√ßalho da se√ß√£o */
    .titulo {
      background-color: #ff6f00;
      color: #fff;
      padding: 10px;
      text-align: center;
      font-size: 1.5em;
      margin-bottom: 20px;
      border-radius: 8px 8px 0 0;
    }

    /* Container do formul√°rio (exceto carimbo) */
    .container {
      border: none;
      padding: 0px;
      background-color: #ffffff;
      border-radius: 8px;
      margin: 10px 40px 40px 40px;
    }

    /* Estilos para inputs, selects e textarea */
    input[type="text"],
    input[type="datetime-local"],
    select,
    textarea {
      width: 100%;
      padding: 8px;
      margin: 5px 0 15px 0;
      border: 1px solid #a09d97f0;
      border-radius: 8px;
      box-sizing: border-box;
      transition: border-color 0.3s ease;
      
      
    }
    input:focus,
    select:focus,
    textarea:focus {
      border-color: #e65c00;
      outline: none;
    }

    /* Bot√µes */
    .botoes, .botoes-1 {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }
    .botoes button,
    .botoes-1 button,
    button[type="submit"] {
      background-color: #ff6f00;
      color: #fff;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 8px;
      font-size: 16px;
      transition: background-color 0.3s ease;
    }
    .botoes button:hover,
    .botoes-1 button:hover,
    button[type="submit"]:hover {
      background-color: #e65c00;
    }

    /* Estiliza√ß√£o da tabela principal */
    .tabela-container-1 {
      width: 135vw;
      max-width: 97%;
      min-width: 97%;
      overflow-x: auto;
      background: white;
      padding: 0px;
      margin:  auto 20px;
      border-radius: 8px;
      box-shadow: 0 9px 10px rgba(255, 157, 0, 0.585);
      font-size: 17px;
      border: 2px solid #dbdbdb;
      zoom: 55%;
    }
    .tabela-container-1 table {
      width: 100%;
      border-collapse: collapse;
    }
    .tabela-container-1 th, 
    .tabela-container-1 td {
      padding: 10px;
      text-align: left;
      height: 50px;
      padding: 8px;
      text-align: center;
    }
    .tabela-container-1 td {
     white-space: nowrap; /* Impede que o texto quebre para a pr√≥xima linha */
  overflow: none; /* Esconde qualquer conte√∫do que ultrapasse o tamanho da c√©lula */
  max-width: 50px; /* Define um tamanho m√°ximo para as c√©lulas (ajuste conforme necess√°rio) */
    }
    .tabela-container-1 th {
      background-color: #ff6f00;
      color: #fff;
    }
    /* Separa√ß√£o sutil entre linhas */
    .tabela-container-1 tr {
      border-bottom: 1px solid #eee;
    }
    .tabela-container-1 tr:last-child {
      border-bottom: none;
    }

    /* Estilos para a segunda tabela */
    .tabela-container {
      width: 93vw;
      max-width: 100%;
      overflow-x: auto;
      background: white;
      padding: 5px;
      margin-left: 90px;
      border-radius: 8px;
      border: 1px solid #d3d3d3;
    }

    /* ============================ */
    /* Estilos do CARIMBO - manter inalterado */
    /* ============================ */
    .carimbo {
  border: 4px solid #9f4500ce;
  padding: 10px;
  margin: 20px auto;
  display: none;
  width: 600px;
  border-radius: 14px;
  background: linear-gradient(#ff6f00fa, #d75a06);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.carimboTitulo {
  background-color: #ff6f00;
  color: #000000;
  padding: 10px;
  text-align: center;
  font-size: 1.3em;
  font-weight: bold;
  margin-bottom: 0px;
  border-top-left-radius: 8px;
  border-top-right-radius: 8px;
}

/* Para permitir bordas arredondadas em c√©lulas, usamos 'separate' com espa√ßamento */
.carimbo table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 3px;
}

.carimbo th,
.carimbo td {
  padding: 8px;
  text-align: left;
  border: 3px solid #ff6f00;
  border-radius: 5px;
  font-weight: 200;
  
}

.carimbo th {
  background-color: #ff6f00;
  color: #000000;
  font-weight: bold;
 }

.carimbo td {
  background-color: #ffffff;
  border: 2px solid #773400b6;
}


  </style>
</head>
<body>
  <div class="container-principal">
    <div class="tabela-container-1">
      <table id="tabela">
        <thead>
          <tr>
            <th style="width: 90px;">TA METRO</th>
            <th style="width: 70px;">DW LINHA</th>
            <th style="width: 70px;">TA RAIZ</th>
            <th style="width: 100px;">LOCALIDADE</th>
            <th style="width: 100px;">ROTA</th>
            <th style="width: 100px;">DATA ALARME</th>
            <th style="width: 120px;">TEMPO CORRIDO</th>
            <th style="width: 90px;">RISCO FTTX</th>
            <th style="width: 90px;">RISCO ADSL</th>
            <th style="width: 130px;">AFET ERB</th>
            <th style="width: 120px;">TOTAL RISCO</th>
            <th style="width: 120px;">AFET FTTX</th>
            <th style="width: 90px;">AFET ADSL</th>
            <th style="width: 90px;">AFET TOTAL</th>
            <th style="width: 130px;">RESUMO STATUS</th>
            <th style="width: 120px;">AREA RESPONSAVEL</th>
            <th style="width: 90px;">EVENTOS ENVOLVIDOS</th>
            <th style="width: 90px;">TECNOLOGIA</th>
            <th style="width: 130px;">TTMC</th>
            <th style="width: 120px;">ADJ, SPC</th>
          </tr>
        </thead>
        <tbody id="tabela-body"></tbody>
      </table>
    </div>

    <div class="botoes">
      <button class="limparTabela">Limpar</button>
    </div>

    <div class="container">
      <div class="titulo">NT-SPI üå°Ô∏è Escalonamentos üå°Ô∏è</div>
      <h1>Formul√°rio Escalonamento</h1>
      <form id="meuFormulario">
        <label for="escalonamento">Escalonamento:</label>
        <select id="escalonamento" name="escalonamento" required>
          <option value="" hidden>SELECIONAR O TIPO</option>
          <option value="OLT-LINK">OLT-LINK</option>
          <option value="INFRA">INFRA</option>
          <option value="OLT-DOWN">OLT-DOWN</option>
          <option value="DRACO">DRACO</option>
          <option value="DWDM">DWDM</option>
          <option value="HL4">HL4</option>
          <option value="METRO">METRO</option>
          <option value="M√ìVEL">M√ìVEL</option>
          <option value="ADJAC√äNCIA">ADJANC√äNCIA</option>
          <option value="BBN">BBN</option>
          <option value="CONDOM√çNIO PLANTA INTERNA">CONDOM√çNIO PLANTA INTERNA</option>
        </select>

        <label for="municipio">Municipio:</label>
        <input type="text" id="municipio" name="municipio" required>
        
        <label for="ta">TA:</label>
        <input type="text" id="ta" name="ta" required>
        
        <label for="dataAbertura">Data Abertura:</label>
        <input type="datetime-local" id="dataAbertura" name="dataAbertura" required>
        
        <label for="taRaiz">TA Raiz:</label>
        <input type="text" id="taRaiz" name="taRaiz" required>
        
        <label for="gestorAtual">Gestor Atual:</label>
        <select id="gestorAtual" name="gestorAtual" required>
          <option value="" hidden>SELECIONAR</option>
          <option value="N1 - ABILITY">N1 - ABILITY</option>
          <option value="N1 - TEL">N1 - TEL</option>
          <option value="REDE - TEL">REDE - TEL</option>
          <option value="REDE - ICOMON">REDE - ICOMON</option>
          <option value="NOC">NOC</option>
          <option value="N2">N2</option>
          <option value="O&M ACESSO VIVO_N1_SPI">O&M ACESSO VIVO_N1_SPI</option>
          <option value="SUPORTE">SUPORTE</option>
          <option value="SWAP">SWAP</option>
          <option value="CO-N1">CO-N1</option>
          <option value="SOBRESSALENTE CHAMADO INTERNO">SOBRESSALENTE INTERNO</option>
          <option value="SOBRESSALENTE FORNECEDOR">SOBRESSALENTE FORNECEDOR</option>
          <option value="OPERACAO RF">OPERACAO RF</option>
          <option value="OPERACAO MOVEL BACKHAUL">OPERACAO MOVEL BACKHAUL</option>
          <option value="OPERA√á√ÉO BANDA LARGA">OPERA√á√ÉO BANDA LARGA</option>
          <option value="OPERA√á√ÉO DWDM">OPERA√á√ÉO DWDM</option>
          <option value="OPERA√á√ÉO REDE IP">OPERA√á√ÉO REDE IP</option>
          <option value="N1 CAPITAL">N1 CAPITAL</option>
          <option value="N1 SUDESTE">N1 SUDESTE</option>
          <option value="REDE SUDESTE">REDE SUDESTE</option>
          <option value="REDE CAPITAL">REDE CAPITAL</option>
        </select>
        
        <label for="tempoNoc">Tempo NOC (horas):</label>
        <input type="text" id="tempoNoc" name="tempoNoc" required pattern="^[0-9]+:[0-5][0-9]$" placeholder="HH:MM">
        
        <label for="tempoN1">Tempo N1 (horas):</label>
        <input type="text" id="tempoN1" name="tempoN1" required pattern="^[0-9]+:[0-5][0-9]$" placeholder="HH:MM">
        
        <label for="tempoRede">Tempo Rede (horas):</label>
        <input type="text" id="tempoRede" name="tempoRede" required pattern="^[0-9]+:[0-5][0-9]$" placeholder="HH:MM">
        
        <!-- Campo para selecionar "Outro" -->
        <label for="outroTipo">Outro:</label>
        <input type="checkbox" id="outroTipo" name="outroTipo" onclick="toggleOutroOptions()">
        
        <div id="outroOptions" style="display: none;">
          <label for="outrosOPP"></label>
          <select id="outrosOPP" name="outrosOPP" onchange="atualizarTituloTempoOutro()">
            <option value="" hidden>Outros</option>
            <option value="N2">N2</option>
            <option value="SUPORTE">SUPORTE</option>
            <option value="SWAP">SWAP</option>
            <option value="CO-N1">CO-N1</option>
            <option value="SOBRESSALENTE CHAMADO INTERNO">SOBRESSALENTE INTERNO</option>
            <option value="SOBRESSALENTE FORNECEDOR">SOBRESSALENTE FORNECEDOR</option>
            <option value="OPERACAO RF">OPERACAO RF</option>
            <option value="OPERACAO MOVEL BACKHAUL">OPERACAO MOVEL BACKHAUL</option>
            <option value="OPERA√á√ÉO BANDA LARGA">OPERA√á√ÉO BANDA LARGA</option>
            <option value="OPERA√á√ÉO DWDM">OPERA√á√ÉO DWDM</option>
            <option value="OPERA√á√ÉO REDE IP">OPERA√á√ÉO REDE IP</option>
            <option value="N1 CAPITAL">N1 CAPITAL</option>
            <option value="N1 SUDESTE">N1 SUDESTE</option>
            <option value="REDE SUDESTE">REDE SUDESTE</option>
            <option value="REDE CAPITAL">REDE CAPITAL</option>
          </select>
          <input type="text" id="tempoOutro" name="tempoOutro" pattern="^[0-9]+:[0-5][0-9]$" placeholder="HH:MM">
        </div><br>
        
        <label for="nivel" style="margin-top: 5px;">N√≠vel:</label>
        <select id="nivel" name="nivel" required>
          <option value="" hidden>SELECIONAR</option>
          <option value="COORDENADOR">COORDENADOR</option>
          <option value="GERENTE">GERENTE</option>
          <option value="SENIOR">SENIOR</option>
          <option value="DIRETOR">DIRETOR</option>
        </select>
        
        <label for="status">Status:</label>
        <textarea id="status" name="status" required></textarea>
        
        <input type="hidden" id="envio" name="envio" value="">
        <button type="submit">Enviar</button>
        
        <!-- Carimbo (sem altera√ß√µes) -->
        <div class="carimbo" id="carimbo">
          <div class="carimboTitulo" style="text-align: center;">NT-SPI üå°Ô∏è Escalonamentos üå°Ô∏è</div>
          <table>
            <tr>
              <th style="text-align: center;">Descri√ß√£o</th>
              <th style="text-align: center;">Atualiza√ß√£o</th>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">Escalonamento</td>
              <td><span id="carimboEscalonamento"></span></td>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">Municipio</td>
              <td><span id="carimboMunicipio"></span></td>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">TA</td>
              <td><span id="carimboTA"></span></td>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">Data Abertura</td>
              <td><span id="carimboDataAbertura"></span></td>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">TA Raiz</td>
              <td><span id="carimboTARaiz"></span></td>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">Gestor Atual</td>
              <td><span id="carimboGestorAtual"></span></td>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">Tempo NOC</td>
              <td><span id="carimboTempoNoc"></span></td>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">Tempo N1</td>
              <td><span id="carimboTempoN1"></span></td>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">Tempo Rede</td>
              <td><span id="carimboTempoRede"></span></td>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">Tempo Total (NOC, N1, Rede)</td>
              <td><span id="carimboTempoTotal"></span></td>
            </tr>
            <tr id="outroRow" style="display: none;">
              <td id="tituloTempoOutro" style="background-color: #e5e5e5; text-align: center;">Tempo Outros</td>
              <td><span id="carimboTempoOutro"></span></td>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">N√≠vel</td>
              <td><span id="carimboNivel"></span></td>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">Status</td>
              <td><span id="carimboStatus"></span></td>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">Envio</td>
              <td><span id="carimboEnvio"></span></td>
            </tr>
            <tr>
              <td style="background-color: #e5e5e5; text-align: center;">Tempo TA</td>
              <td><span id="carimboTempoTA"></span></td>
            </tr>
          </table>
          <div class="botoes">
            <button id="voltar">Voltar</button>
            
          </div>
        </div>
      </form>
    </div>
  </div>
 <script>

document.addEventListener("DOMContentLoaded", function () {
    function preencherFormulario() {
        let tabela = document.querySelector("table");
        if (!tabela) return;

        let linhas = tabela.querySelectorAll("tbody tr");
        if (linhas.length === 0) return;

        let ultimaLinha = linhas[linhas.length - 1];
        let colunas = ultimaLinha.querySelectorAll("td");

        if (colunas.length < 4) return; // Garante que tem colunas suficientes antes de preencher

        let ta = colunas[1].textContent.trim(); // Coluna DWDM LINHA
        let taRaiz = colunas[2].textContent.trim(); // Coluna TA RAIZ (REDE)
        let dataAbertura = colunas[5].textContent.trim(); // Coluna DATA ALARME
        let municipioCompleto = colunas[3].textContent.trim(); // Coluna LOCALIDADE (Munic√≠pio)

        // Pegando apenas o que vem antes do "-" no munic√≠pio
        let municipio = municipioCompleto.split("-")[0].trim();

        // Preenchendo os campos do formul√°rio
        document.getElementById("ta").value = ta;
        document.getElementById("taRaiz").value = taRaiz;
        document.getElementById("dataAbertura").value = formatarData(dataAbertura);
        document.getElementById("municipio").value = municipio; // Adicionando o munic√≠pio
    }

    function formatarData(data) {
        if (!data) return "";
        let partes = data.split(" ");
        if (partes.length < 2) return "";

        let [dia, mes, ano] = partes[0].split("/");
        let horario = partes[1];

        return `${ano}-${mes}-${dia}T${horario}`;
    }

    let observer = new MutationObserver(preencherFormulario);
    let tabela = document.querySelector("table");

    if (tabela) {
        observer.observe(tabela, { childList: true, subtree: true });
    }
});











function criarLinha(celulas = 20, valores = []) {
            let tabela = document.getElementById("tabela-body");
            let novaLinha = tabela.rows[0];

            if (novaLinha) {
                for (let i = 0; i < celulas; i++) {
                    novaLinha.cells[i].textContent = valores[i] || "";
                }
            } else {
                novaLinha = tabela.insertRow();
                for (let i = 0; i < celulas; i++) {
                    let celula = novaLinha.insertCell();
                    celula.contentEditable = "true";
                    celula.textContent = valores[i] || "";
                }
            }
        }

        function inicializarTabela(linhas = 1) {
            let tabela = document.getElementById("tabela-body");
            tabela.innerHTML = "";
            for (let i = 0; i < linhas; i++) {
                criarLinha();
            }
        }

        document.addEventListener("paste", function(event) {
    let target = event.target;
    if (target.tagName.toLowerCase() === 'td') {
        event.preventDefault();
        let pasteData = event.clipboardData.getData("text");

        // Substituir quebras de linha dentro de c√©lulas por espa√ßo para evitar divis√£o incorreta
        pasteData = pasteData.replace(/([^\t])\n([^\t])/g, "$1 $2");

        let linhas = pasteData.split("\n").filter(linha => linha.trim() !== "");
        let tabela = target.closest("table"); // Pega a tabela mais pr√≥xima
        let ultimaLinhaIndex = target.parentNode.rowIndex; // Obt√©m o √≠ndice da linha onde come√ßou a colagem

        linhas.forEach((linha, linhaIndex) => {
            let colunas = linha.split("\t");
            let linhaTabela = tabela.rows[ultimaLinhaIndex];

            if (linhaTabela) {
                if (linhaIndex === 0) {
                    // Primeira linha: Preencher normalmente
                    colunas.forEach((valor, colunaIndex) => {
                        let celula = linhaTabela.cells[colunaIndex];
                        if (celula) {
                            celula.innerText = valor;
                        }
                    });
                } else {
                    // Segunda linha: Adicionar os dados na pr√≥xima c√©lula vazia da linha principal
                    let ultimaCelulaIndex = [...linhaTabela.cells].findIndex(celula => celula.innerText.trim() === "");
                    let celulaDestino = linhaTabela.cells[ultimaCelulaIndex] || linhaTabela.insertCell(-1);
                    celulaDestino.innerText = colunas.join(" "); // Junta tudo para evitar separa√ß√£o errada
                }
            }
        });
    }
});



        function limparTabela() {
            inicializarTabela();
        }

        // Associar o evento de clique no bot√£o "Limpar"
        document.querySelector(".limparTabela").addEventListener("click", limparTabela);

        inicializarTabela();


function atualizarTituloTempoOutro() {
    const outrosOPP = document.getElementById("outrosOPP").value;
    const titulo = document.getElementById("tituloTempoOutro");

    if (escalonamento) {
      titulo.innerText = `Tempo Outros (${outrosOPP})`;
    } else {
      titulo.innerText = "Tempo Outros"; // Caso n√£o tenha nada selecionado
    }
  }

function toggleOutroOptions() {
    var outroDiv = document.getElementById("outroOptions");
    var outroCheckBox = document.getElementById("outroTipo");
    
    if (outroCheckBox.checked) {
        outroDiv.style.display = "block";
        document.getElementById("outroRow").style.display = "table-row"; // Mostra a linha de 'Tempo Outros'
        document.getElementById("carimboTempoOutro").innerText = document.getElementById("tempoOutro").value; // Adiciona o tempo do outro
    } else {
        outroDiv.style.display = "none";
        document.getElementById("outroRow").style.display = "none"; // Oculta a linha de 'Tempo Outros'
        document.getElementById("carimboTempoOutro").innerText = ''; // Limpa o campo
    }
}

 
 document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll("input[type='text'][name^='tempo']").forEach(input => {
        input.addEventListener("input", function (event) {
            let value = this.value.replace(/[^0-9]/g, ""); // Remove caracteres n√£o num√©ricos

            // Limitar o valor a no m√°ximo 6 caracteres
            if (value.length > 5) {
                value = value.slice(0, 5);
            }

            if (value.length > 3) {
                let horas = value.slice(0, value.length - 2); // Tudo antes dos √∫ltimos 2 d√≠gitos
                let minutos = value.slice(-2); // √öltimos 2 d√≠gitos

                // Ajusta os minutos para 59 se for maior que 59
                if (parseInt(minutos) > 59) {
                    minutos = "59";
                }

                this.value = `${horas}:${minutos}`;
            } else {
                this.value = value;
            }
        });
    });
});
 document.getElementById('meuFormulario').addEventListener('submit', function(event) {
 event.preventDefault();
 var escalonamento = document.getElementById('escalonamento').value;
 var municipio = document.getElementById('municipio').value;
 var ta = document.getElementById('ta').value;
 var dataAbertura = document.getElementById('dataAbertura').value;
 var taRaiz = document.getElementById('taRaiz').value;
 var gestorAtual = document.getElementById('gestorAtual').value;
 var tempoNoc = document.getElementById('tempoNoc').value;
 var tempoN1 = document.getElementById('tempoN1').value;
 var tempoRede = document.getElementById('tempoRede').value;
 var tempoOutro = document.getElementById('tempoOutro').value;
 var tempoTotal = calcularTempoTotal(tempoNoc, tempoN1, tempoRede);
 var nivel = document.getElementById('nivel').value;
 var status = document.getElementById('status').value;
 var envio = new Date().toISOString();
 var envioFormatado = formatarDataHora(envio);
 var tempoTA = calcularTempoTA(dataAbertura, envio);

 function formatarDataHora(dataHora) {
   if (!dataHora) return '';
   var data = new Date(dataHora);
   var dia = String(data.getDate()).padStart(2, '0');
   var mes = String(data.getMonth() + 1).padStart(2, '0');
   var ano = data.getFullYear();
   var horas = String(data.getHours()).padStart(2, '0');
   var minutos = String(data.getMinutes()).padStart(2, '0');
   return `${dia}/${mes}/${ano} ${horas}:${minutos}`;
 }

 function calcularTempoTotal(tempoNoc, tempoN1, tempoRede) {
   var [horasNoc, minutosNoc] = tempoNoc.split(':').map(Number);
   var [horasN1, minutosN1] = tempoN1.split(':').map(Number);
   var [horasRede, minutosRede] = tempoRede.split(':').map(Number);
   var totalMinutos = (horasNoc * 60 + minutosNoc) + (horasN1 * 60 + minutosN1) + (horasRede * 60 + minutosRede);
   var totalHoras = Math.floor(totalMinutos / 60);
   var totalMinutosRestantes = totalMinutos % 60;
   return `${String(totalHoras).padStart(2, '0')}:${String(totalMinutosRestantes).padStart(2, '0')}`;
 }

 function calcularTempoTA(dataAbertura, envio) {
   var dataAberturaDate = new Date(dataAbertura);
   var envioDate = new Date(envio);
   var diffMs = envioDate - dataAberturaDate;
   var diffHrs = Math.floor(diffMs / (1000 * 60 * 60));
   var diffMins = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));
   return `${String(diffHrs).padStart(2, '0')}:${String(diffMins).padStart(2, '0')}`;
 }

 document.getElementById('carimboEscalonamento').textContent = escalonamento;
 document.getElementById('carimboMunicipio').textContent = municipio;
 document.getElementById('carimboTA').textContent = ta;
 document.getElementById('carimboDataAbertura').textContent = formatarDataHora(dataAbertura);
 document.getElementById('carimboTARaiz').textContent = taRaiz;
 document.getElementById('carimboGestorAtual').textContent = gestorAtual;
 document.getElementById('carimboTempoNoc').textContent = tempoNoc;
 document.getElementById('carimboTempoN1').textContent = tempoN1;
 document.getElementById('carimboTempoRede').textContent = tempoRede;
 document.getElementById('carimboTempoOutro').textContent = tempoOutro;
 document.getElementById('carimboTempoTotal').textContent = tempoTotal;
 document.getElementById('carimboNivel').textContent = nivel;
 document.getElementById('carimboStatus').textContent = status;
 document.getElementById('carimboEnvio').textContent = envioFormatado;
 document.getElementById('carimboTempoTA').textContent = tempoTA;
 document.getElementById('carimbo').style.display = 'block';
});

document.getElementById('voltar').addEventListener('click', function() {
 document.getElementById('carimbo').style.display = 'none';
 document.getElementById('meuFormulario').reset();
});
</script>
</body>
</html>

<div class="sair">
  <img src="icons/HP.png" alt="√çcone de Porta" class="icone-porta">
  <span>Sair</span>
</div>

<style>
  .sair {
      position: fixed;
      top: 10px;
      left: 10px;
      display: flex;
      align-items: center;
      cursor: pointer;
      z-index: 9999; /* Fica sempre no topo */
      background-color: rgba(255, 255, 255, 0.8); /* Fundo branco com leve transpar√™ncia */
      padding: 5px;
      border-radius: 8px;
  }

  .icone-porta {
      width: 30px;
      height: 30px;
      margin-right: 5px;
  }

  .sair span {
      font-size: 18px;
      font-weight: bold;
  }

  .sair:hover {
      opacity: 0.8;
  }
</style>

<script>
  document.querySelector('.sair').addEventListener('click', function() {
      window.location.href = "HOME.html"; // Substitua com o caminho da sua p√°gina
  });
</script>
